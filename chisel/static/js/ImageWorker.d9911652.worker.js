!function(r){var t={};function n(a){if(t[a])return t[a].exports;var e=t[a]={i:a,l:!1,exports:{}};return r[a].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=r,n.c=t,n.d=function(r,t,a){n.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:a})},n.r=function(r){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,t){if(1&t&&(r=n(r)),8&t)return r;if(4&t&&"object"===typeof r&&r&&r.__esModule)return r;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var e in r)n.d(a,e,function(t){return r[t]}.bind(null,e));return a},n.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(t,"a",t),t},n.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},n.p="/",n(n.s=0)}([function(r,t,n){"use strict";function a(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=r[n];return a}function e(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r)){var n=[],a=!0,e=!1,o=void 0;try{for(var i,u=r[Symbol.iterator]();!(a=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(f){e=!0,o=f}finally{try{a||null==u.return||u.return()}finally{if(e)throw o}}return n}}(r,t)||function(r,t){if(r){if("string"===typeof r)return a(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(r,t):void 0}}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(r,t){for(var n=new Uint8Array(4*t),a=0;a<t;a++){var e=Math.max(0,Math.min(255,r[a]));n[4*a]=n[4*a+1]=n[4*a+2]=e,n[4*a+3]=255}return n}function i(r,t,n){var a=new Uint8Array(t*n);return u(a,r,t,n),a}function u(r,t,n,a){for(var e=0;e<n*a;e++){var o=t[4*e],i=t[4*e+1],u=t[4*e+2];r[e]=Math.round(.3*o+.59*i+.11*u)}}function f(r,t,n,a){for(var e=0;e<a;e++)c(r,t,n,a,e,0,n-1)}function c(r,t,n,a,e,o,i){for(var u,f,c,v,s,y,l=e*n,b=0==e?l:l-n,m=e==a-1?l:l+n,h=o;h<=i;h++){var d=Math.max(0,h-1),p=Math.min(n-1,h+1);r[l+h]=(u=t[b+d],f=t[b+p],c=t[l+d],v=t[l+p],s=t[m+d],y=t[m+p],Math.abs(-u+f-2*c+2*v-y+s))}}function v(r,t,n){var a=function(r){return r.reduce((function(r,t){return r+t}))},e=4*a(r)+2*a(t)+a(n),o=new ArrayBuffer(e),i=0;return[r.map((function(r){var t=new Uint32Array(o,i,r);return i+=4*r,t})),t.map((function(r){var t=new Uint16Array(o,i,r);return i+=2*r,t})),n.map((function(r){var t=new Uint8Array(o,i,r);return i+=r,t}))]}function s(r,t,n,a,e,o,i){for(var u=0;u<t;u++){var f=r.subarray(u*o,(u+1)*o);y(f,i,a,e,o),l(n,e,o,f),l(a,e,o,f),e--;for(var v=0;v<o;v++){var s=f[v];c(a,n,e,o,v,Math.max(0,s-2),Math.max(e-1,s+2))}}for(var b=t-1;b>=0;b--)for(var m=r.subarray(b*o,(b+1)*o),h=b-1;h>=0;h--)for(var d=r.subarray(h*o,(h+1)*o),p=0;p<o;p++)d[p]<=m[p]&&m[p]++}function y(r,t,n,a,e){for(var o=0;o<a;o++)t[o]=n[o]<<2;for(var i=1;i<e;i++)for(var u=i*a,f=(i-1)*a,c=0;c<a;c++){var v=-4&t[f+c];c>0&&(v=Math.min(v,-4&t[f+c-1]|1)),c<a-1&&(v=Math.min(v,-4&t[f+c+1]|2)),t[u+c]=v+(n[u+c]<<2)}for(var s=(e-1)*a,y={value:t[s],x:0},l=1;l<a;l++){var b=t[s+l];b<y.value&&(y={value:b,x:l})}for(var m=e-1,h=y.x;m>=0;m--){r[m]=h;var d=t[m*a+h];0!==(1&d)?h--:0!==(2&d)&&h++}}function l(r,t,n,a){for(var e=0;e<n;e++){var o=e*t,i=e*(t-1),u=a[e];r.copyWithin(i,o,o+u),r.copyWithin(i+u,o+u+1,o+t)}}function b(r,t,n,a){m(a,r,t,n),r.set(a.subarray(0,t*n))}function m(r,t,n,a){for(var e=0;e<a;e++)for(var o=0;o<n;o++)r[o*a+e]=t[e*n+o]}function h(r,t){function n(r){return[255&r,r>>8&255,r>>16&255,r>>24]}return function(r){return r[0]|r[1]<<8|r[2]<<16|r[3]<<24}(function(r,t){return r.map((function(r,n){return(r+t[n])/2}))}(n(r),n(t)))}n.r(t);var d=self;function p(r,t,n){d.postMessage({rgba:r,width:t,height:n},[r.buffer])}d.addEventListener("message",(function(r){var t=r.data,n=t.image,a=n.rgba,c=n.width,y=n.height,l=performance.now(),d="".concat(t.transformation.command," ").concat(c,"x").concat(y);switch(t.transformation.command){case"carve":var M=t.transformation,w=M.width,g=M.height;d+=" -> ".concat(w,"x").concat(g),p(function(r,t,n,a,o){if(t===a&&n===o)return r;var i=new Uint32Array(r.buffer,r.byteOffset,t*n),c=Math.abs(t-a),y=Math.abs(n-o),l=Math.max(t,a)*Math.max(n,o),d=Math.max(t,a)*n,p=e(v([l],[Math.max(c*n,y*a),d],[d]),3),M=e(p[0],1)[0],w=e(p[1],2),g=w[0],x=w[1],A=e(p[2],1)[0],U=new Uint16Array(M.buffer,M.byteOffset,2*M.length),O=new Uint32Array(a*Math.max(n,o)),j=new Uint8Array(O.buffer),S=function(r,t,n,a,e){s(g,a,A,x,t,n,M),b(g,n,a,U);for(var o=r===O?M:O,i=0,u=function(n){var u=n*t,f=g.subarray(a*n,a*(n+1));f.sort();var c=0,v=function(t,n){o.set(r.subarray(u+t,u+n),i),i+=n-t};f.forEach((function(n){if(v(c,n),!e){var a=Math.max(0,n-1),f=Math.min(t-1,n+1);o[i++]=h(r[u+a],r[u+n]),o[i++]=h(r[u+n],r[u+f])}c=n+1})),v(c,t)},f=0;f<n;f++)u(f);o!==O&&O.set(o.subarray(0,i))};return t!==a&&(u(A,r,t,n),f(x,A,t,n),S(i,t,n,c,a<t)),n!==o&&(t===a?m(O,i,t,n):b(O,a,n,M),u(A,j,n,a),f(x,A,n,a),S(O,n,a,y,o<n),b(O,o,a,M)),j.subarray(0,4*a*o)}(a,c,y,w,g),w,g);break;case"highlight":var x=t.transformation,A=x.axis,U=x.count;d+=" ".concat(U," ").concat(A),p(function(r,t,n,a,o){if(0===o)return r;var i=new Uint32Array(r.buffer,r.byteOffset,t*n),c=t*n,y=e(v([c],[(a?n:t)*o,c],[c]),3),l=e(y[0],1)[0],h=e(y[1],2),d=h[0],p=h[1],M=e(y[2],1)[0],w=new Uint32Array(t*n),g=new Uint8Array(w.buffer),x=function(r,t){s(d,o,M,p,r,t,l);for(var n=0;n<o;n++)for(var a=d.subarray(n*t,(n+1)*t),e=0;e<t;e++){var i=a[e];g.set([255,0,255,255],4*(e*r+i))}};return a?(w.set(i.subarray(0,t*n)),u(M,r,t,n),f(p,M,t,n),x(t,n)):(m(w,i,t,n),u(M,g,n,t),f(p,M,n,t),x(n,t),b(w,n,t,l)),g}(a,c,y,"vertical"===A,U),c,y);break;case"gradient":var O=t.transformation.axis;d+=" ".concat(O);var j=i(a,c,y);p(o("vertical"===O?function(r,t,n){for(var a,e,o,i,u,f,c=new Uint16Array(t*n),v=0;v<n;v++)for(var s=t*v,y=0===v?0:s-t,l=v===n-1?s:s+t,b=0;b<t;b++){var m=Math.max(0,b-1),h=Math.min(t-1,b+1);c[s+b]=(a=r[y+m],e=r[y+b],o=r[y+h],i=r[l+m],u=r[l+b],f=r[l+h],Math.abs(-a-2*e-o+i+2*u+f))}return c}(j,c,y):function(r,t,n){var a=new Uint16Array(t*n);return f(a,r,t,n),a}(j,c,y),c*y),c,y);break;case"intensity":p(o(i(a,c,y),c*y),c,y)}console.log("".concat(d,": ").concat(performance.now()-l,"ms"))}))}]);
//# sourceMappingURL=ImageWorker.d9911652.worker.js.map